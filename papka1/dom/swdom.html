<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Расписание занятий</title>
<!-- Подключение Bootstrap -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"/>
<style>
  .activity {
    border: 1px solid #dee2e6;
    padding: 15px;
    margin-bottom: 10px;
    border-radius: 8px;
  }
</style>
</head>
<body class="p-4">

<h1 class="mb-4">Расписание занятий</h1>

<div id="scheduleContainer"></div>

<script>
// Пример исходных данных о занятиях
const scheduleData = [
  {
    id: 1,
    name: "Йога",
    time: "08:00 - 09:00",
    maxParticipants: 10,
    currentParticipants: 0
  },
  {
    id: 2,
    name: "Тренажерный зал",
    time: "09:30 - 11:00",
    maxParticipants: 15,
    currentParticipants: 0
  },
  {
    id: 3,
    name: "Бокс",
    time: "12:00 - 13:00",
    maxParticipants: 8,
    currentParticipants: 0
  }
];

// Загружаем данные о записях из localStorage или используем исходные
let activities = JSON.parse(localStorage.getItem('activities')) || scheduleData;

// Функция отображения расписания
function renderSchedule() {
  const container = document.getElementById('scheduleContainer');
  container.innerHTML = '';

  activities.forEach(activity => {
    const activityDiv = document.createElement('div');
    activityDiv.className = 'activity';

    // Заголовок и описание
    activityDiv.innerHTML = `
      <h4>${activity.name}</h4>
      <p><strong>Время:</strong> ${activity.time}</p>
      <p><strong>Максимум участников:</strong> ${activity.maxParticipants}</p>
      <p><strong>Записано участников:</strong> <span id="count-${activity.id}">${activity.currentParticipants}</span></p>
      <div class="d-flex gap-2">
        <button class="btn btn-primary" id="register-${activity.id}">Записаться</button>
        <button class="btn btn-secondary" id="cancel-${activity.id}">Отменить запись</button>
      </div>
    `;
    container.appendChild(activityDiv);

    // Получаем кнопки
    const registerBtn = document.getElementById(`register-${activity.id}`);
    const cancelBtn = document.getElementById(`cancel-${activity.id}`);
    const countSpan = document.getElementById(`count-${activity.id}`);

    // Обновляем состояние кнопок
    updateButtonState(activity, registerBtn);

    // Обработчики
    registerBtn.onclick = () => {
      if (activity.currentParticipants < activity.maxParticipants) {
        activity.currentParticipants++;
        countSpan.textContent = activity.currentParticipants;
        saveActivities();
        updateButtonState(activity, registerBtn);
      }
    };

    cancelBtn.onclick = () => {
      if (activity.currentParticipants > 0) {
        activity.currentParticipants--;
        countSpan.textContent = activity.currentParticipants;
        saveActivities();
        updateButtonState(activity, registerBtn);
      }
    };
  });
}

// Обновление состояния кнопки "Записаться"
function updateButtonState(activity, button) {
  if (activity.currentParticipants >= activity.maxParticipants) {
    button.disabled = true;
  } else {
    button.disabled = false;
  }
}

// Сохранение в localStorage
function saveActivities() {
  localStorage.setItem('activities', JSON.stringify(activities));
}

// Изначальный рендер
renderSchedule();

</script>
</body>
</html>